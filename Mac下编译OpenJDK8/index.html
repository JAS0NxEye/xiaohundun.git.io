<!DOCTYPE html>
<html lang=zh>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta name="google-site-verification" content="B8rnJ7lT52074wiXfBUlgTf5PiOM5P5hi_bJNV0n3yg">
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="当前环境  Mac 10.14.1 JDK 1.8.0_181   下载源码  去官网下载源码:OpenJDK8下载 当我想要去直接下载压缩包时,网站却遇到技术问题(无法使用),所以我还是用了下面的方法 使用 Mercurial 版本管理工具拉取代码: OpenJDK主页 Homebrew安装  1$ brew install mercurial 拉取项目 123hg clone http://">
<meta name="keywords" content="OpenJDK8">
<meta property="og:type" content="article">
<meta property="og:title" content="Mac下编译OpenJDK8及虚拟机实践">
<meta property="og:url" content="http://blog.elegantme.cn/Mac下编译OpenJDK8/index.html">
<meta property="og:site_name" content="xiaohundun的博客 分享-学习-有趣的灵魂">
<meta property="og:description" content="当前环境  Mac 10.14.1 JDK 1.8.0_181   下载源码  去官网下载源码:OpenJDK8下载 当我想要去直接下载压缩包时,网站却遇到技术问题(无法使用),所以我还是用了下面的方法 使用 Mercurial 版本管理工具拉取代码: OpenJDK主页 Homebrew安装  1$ brew install mercurial 拉取项目 123hg clone http://">
<meta property="og:locale" content="zh">
<meta property="og:image" content="http://blog.elegantme.cn/Mac下编译OpenJDK8/1.png">
<meta property="og:updated_time" content="2018-11-26T03:21:18.692Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Mac下编译OpenJDK8及虚拟机实践">
<meta name="twitter:description" content="当前环境  Mac 10.14.1 JDK 1.8.0_181   下载源码  去官网下载源码:OpenJDK8下载 当我想要去直接下载压缩包时,网站却遇到技术问题(无法使用),所以我还是用了下面的方法 使用 Mercurial 版本管理工具拉取代码: OpenJDK主页 Homebrew安装  1$ brew install mercurial 拉取项目 123hg clone http://">
<meta name="twitter:image" content="http://blog.elegantme.cn/Mac下编译OpenJDK8/1.png">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Mac下编译OpenJDK8及虚拟机实践</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/xiaohundun">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </span>
    <br>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/Java-Virtual-Machine知识及实践/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/Spring-Boot启动类SpringApplication解析/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://blog.elegantme.cn/Mac下编译OpenJDK8/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&text=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&is_video=false&description=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Mac下编译OpenJDK8及虚拟机实践&body=Check out this article: http://blog.elegantme.cn/Mac下编译OpenJDK8/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&name=Mac下编译OpenJDK8及虚拟机实践&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#当前环境"><span class="toc-number">1.</span> <span class="toc-text"> 当前环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#下载源码"><span class="toc-number">2.</span> <span class="toc-text"> 下载源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装依赖"><span class="toc-number">3.</span> <span class="toc-text"> 安装依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#xquartz"><span class="toc-number">3.1.</span> <span class="toc-text"> XQuartz</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#freetype"><span class="toc-number">3.2.</span> <span class="toc-text"> freetype</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gun组件"><span class="toc-number">3.3.</span> <span class="toc-text"> GUN组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#进行编译"><span class="toc-number">4.</span> <span class="toc-text"> 进行编译</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误列表"><span class="toc-number">5.</span> <span class="toc-text"> 错误列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bash-configure过程中可能会遇到的错误"><span class="toc-number">5.1.</span> <span class="toc-text"> bash ./configure过程中可能会遇到的错误:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make-all过程中可能遇到的错误"><span class="toc-number">5.2.</span> <span class="toc-text"> make all过程中可能遇到的错误:</span></a></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope="" itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Mac下编译OpenJDK8及虚拟机实践
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
        <span itemprop="name">xiaohundun的博客 分享-学习-有趣的灵魂</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-11-21T11:51:20.000Z" itemprop="datePublished">2018-11-21</time>
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link" href="/tags/OpenJDK8/">OpenJDK8</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <h2 id="当前环境"><a class="markdownIt-Anchor" href="#当前环境"></a> 当前环境</h2>
<ol>
<li>Mac 10.14.1</li>
<li>JDK 1.8.0_181</li>
</ol>
<h2 id="下载源码"><a class="markdownIt-Anchor" href="#下载源码"></a> 下载源码</h2>
<ul>
<li>去官网下载源码:<a href="http://download.java.net/openjdk/jdk8/" target="_blank" rel="noopener">OpenJDK8下载</a><br>
当我想要去直接下载压缩包时,网站却遇到技术问题(无法使用),所以我还是用了下面的方法</li>
<li>使用 <em>Mercurial</em> 版本管理工具拉取代码: <a href="http://hg.openjdk.java.net/jdk8/jdk8" target="_blank" rel="noopener">OpenJDK主页</a><br>
<a href="https://brew.sh/" target="_blank" rel="noopener">Homebrew安装</a></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ brew install mercurial</span><br></pre></td></tr></table></figure>
<p>拉取项目</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hg <span class="built_in">clone</span> http://hg.openjdk.java.net/jdk8/jdk8 jdk8</span><br><span class="line"><span class="built_in">cd</span> jdk8</span><br><span class="line">bash ./get_source.sh</span><br></pre></td></tr></table></figure>
<p><img src="1.png" alt=""></p>
<h2 id="安装依赖"><a class="markdownIt-Anchor" href="#安装依赖"></a> 安装依赖</h2>
<blockquote>
<p>使用clang编译器,不需要下载xcode</p>
</blockquote>
<h3 id="xquartz"><a class="markdownIt-Anchor" href="#xquartz"></a> XQuartz</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew cask install XQuartz</span><br></pre></td></tr></table></figure>
<h3 id="freetype"><a class="markdownIt-Anchor" href="#freetype"></a> freetype</h3>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install freetype</span><br></pre></td></tr></table></figure>
<h3 id="gun组件"><a class="markdownIt-Anchor" href="#gun组件"></a> GUN组件</h3>
<blockquote>
<p>注意:在接下来的编译过程中,若不需要开启调试,不需要安装此组件</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">brew install binutils</span><br></pre></td></tr></table></figure>
<h2 id="进行编译"><a class="markdownIt-Anchor" href="#进行编译"></a> 进行编译</h2>
<ol>
<li>确保你在jdk8目录中</li>
<li>运行 ./configure<br>
不开启调试</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash ./configure --with-freetype-include=/usr/<span class="built_in">local</span>/include/freetype2 --with-freetype-lib=/usr/<span class="built_in">local</span>/lib/</span><br></pre></td></tr></table></figure>
<p>开启调试</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash ./configure --with-freetype-include=/usr/<span class="built_in">local</span>/include/freetype2 --with-freetype-lib=/usr/<span class="built_in">local</span>/lib/ --with-target-bits=64 --with-debug-level=slowdebug --<span class="built_in">enable</span>-debug-symbols ZIP_DEBUGINFO_FILES=0</span><br></pre></td></tr></table></figure>
<p>开启调试若不<a href="#GUN%E7%BB%84%E4%BB%B6">安装gun组件</a>,将会提示缺少 <em>objcopy</em><br>
如果没有错误,将输出以下内容:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Configuration summary:</span><br><span class="line">* Debug level:    release</span><br><span class="line">* JDK variant:    normal</span><br><span class="line">* JVM variants:   server</span><br><span class="line">* OpenJDK target: OS: macosx, CPU architecture: x86, address length: 64</span><br><span class="line"></span><br><span class="line">Tools summary:</span><br><span class="line">* Boot JDK:       java version <span class="string">"1.8.0_181"</span> Java(TM) SE Runtime Environment (build 1.8.0_181-b13) Java HotSpot(TM) 64-Bit Server VM (build 25.181-b13, mixed mode)  (at /Library/Java/JavaVirtualMachines/jdk1.8.0_181.jdk/Contents/home)</span><br><span class="line">* C Compiler:      version  (at /usr/bin/gcc)</span><br><span class="line">* C++ Compiler:    version  (at /usr/bin/g++)</span><br><span class="line"></span><br><span class="line">Build performance summary:</span><br><span class="line">* Cores to use:   5</span><br><span class="line">* Memory <span class="built_in">limit</span>:   16384 MB</span><br><span class="line">* ccache status:  not installed (consider installing)</span><br><span class="line"></span><br><span class="line">Build performance tip: ccache gives a tremendous speedup <span class="keyword">for</span> C++ recompilations.</span><br><span class="line">You <span class="keyword">do</span> not have ccache installed. Try installing it.</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>创建临时环境变量文件</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch jvm.sh</span><br></pre></td></tr></table></figure>
<p><a href="http://xn--jvm-t29h961e.sh" target="_blank" rel="noopener">编辑jvm.sh</a>,内容如下:</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> LANG=C</span><br><span class="line"><span class="built_in">export</span> CC=clang</span><br><span class="line"><span class="built_in">export</span> COMPILER_WARNINGS_FATAL=<span class="literal">false</span></span><br><span class="line"><span class="built_in">export</span> LFLAGS=<span class="string">'-Xlinker -lstdc++'</span></span><br><span class="line"><span class="built_in">export</span> USE_CLANG=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> LP64=1</span><br><span class="line"><span class="built_in">export</span> ARCH_DATA_MODEL=64</span><br><span class="line"><span class="built_in">export</span> ALLOW_DOWNLOADS=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> HOTSPOT_BUILD_JOBS=3</span><br><span class="line"><span class="built_in">export</span> SKIP_COMPARE_IMAGES=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> USE_PRECOMPILED_HEADER=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> INCREMENTAL_BUILD=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> BUILD_LANGTOOLS=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> BUILD_JAXP=<span class="literal">false</span></span><br><span class="line"><span class="built_in">export</span> BUILD_JAXWS=<span class="literal">false</span></span><br><span class="line"><span class="built_in">export</span> BUILD_CORBA=<span class="literal">false</span></span><br><span class="line"><span class="built_in">export</span> BUILD_HOTSPOT=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> BUILD_JDK=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> SKIP_DEBUG_BUILD=<span class="literal">true</span></span><br><span class="line"><span class="built_in">export</span> SKIP_FASTDEBUG_BUILD=<span class="literal">false</span></span><br><span class="line"><span class="built_in">export</span> DEBUG_NAME=debug</span><br><span class="line"><span class="built_in">export</span> BUILD_DEPLOY=<span class="literal">false</span></span><br><span class="line"><span class="built_in">export</span> BUILD_INSTALL=<span class="literal">false</span></span><br><span class="line"><span class="comment"># 若开启调试,放开下面这一行</span></span><br><span class="line"><span class="comment"># export OBJCOPY=gobjcopy</span></span><br></pre></td></tr></table></figure>
<p>使临时环境变量生效</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">source</span> jvm.sh</span><br></pre></td></tr></table></figure>
<ol start="5">
<li>make all</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">make all</span><br></pre></td></tr></table></figure>
<p>接下来许久没听到声音的风扇狂转<br>
成功信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## Finished docs (build time 00:01:06)</span></span><br><span class="line"></span><br><span class="line">----- Build <span class="built_in">times</span> -------</span><br><span class="line">Start 2018-11-21 23:25:14</span><br><span class="line">End   2018-11-21 23:31:22</span><br><span class="line">00:00:12 corba</span><br><span class="line">00:00:20 demos</span><br><span class="line">00:01:06 docs</span><br><span class="line">00:01:25 hotspot</span><br><span class="line">00:00:39 images</span><br><span class="line">00:00:08 jaxp</span><br><span class="line">00:00:13 jaxws</span><br><span class="line">00:01:41 jdk</span><br><span class="line">00:00:18 langtools</span><br><span class="line">00:00:06 nashorn</span><br><span class="line">00:06:08 TOTAL</span><br><span class="line">-------------------------</span><br><span class="line">Finished building OpenJDK <span class="keyword">for</span> target <span class="string">'all'</span></span><br></pre></td></tr></table></figure>
<p>期间应该会碰到一些错误,请参考下面的错误列表</p>
<h2 id="错误列表"><a class="markdownIt-Anchor" href="#错误列表"></a> 错误列表</h2>
<h3 id="bash-configure过程中可能会遇到的错误"><a class="markdownIt-Anchor" href="#bash-configure过程中可能会遇到的错误"></a> bash ./configure过程中可能会遇到的错误:</h3>
<ol>
<li>解决错误</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">configure: error: GCC compiler is required</span><br></pre></td></tr></table></figure>
<p>编辑 <code>comman/autoconf/generated-configure.sh</code>,注释第20061，21640行</p>
<h3 id="make-all过程中可能遇到的错误"><a class="markdownIt-Anchor" href="#make-all过程中可能遇到的错误"></a> make all过程中可能遇到的错误:</h3>
<ol>
<li>解决错误</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">Users/ydcun-pro/workspace/openjdk/jdk8/hotspot/src/share/vm/code/relocInfo.hpp:367:27: error: friend declaration specifying a default argument must be a definition</span><br><span class="line">      inline friend relocInfo prefix_relocInfo(int datalen = 0);</span><br><span class="line">                              ^</span><br><span class="line">    /Users/ydcun-pro/workspace/openjdk/jdk8/hotspot/src/share/vm/code/relocInfo.hpp:462:18: error: friend declaration specifying a default argument must be the only declaration</span><br><span class="line">    inline relocInfo prefix_relocInfo(int datalen) &#123;</span><br><span class="line">                     ^</span><br><span class="line">    /Users/ydcun-pro/workspace/openjdk/jdk8/hotspot/src/share/vm/code/relocInfo.hpp:367:27: note: previous declaration is here</span><br><span class="line">      inline friend relocInfo prefix_relocInfo(int datalen = 0);</span><br><span class="line">                              ^</span><br><span class="line">    /Users/ydcun-pro/workspace/openjdk/jdk8/hotspot/src/share/vm/code/relocInfo.hpp:464:59: error: <span class="string">'RAW_BITS'</span> is a protected member of <span class="string">'relocInfo'</span></span><br><span class="line">      <span class="built_in">return</span> relocInfo(relocInfo::data_prefix_tag, relocInfo::RAW_BITS, relocInfo::datalen_tag | datalen);</span><br><span class="line">                                                              ^</span><br><span class="line">    /Users/ydcun-pro/workspace/openjdk/jdk8/hotspot/src/share/vm/code/relocInfo.hpp:272:23: note: declared protected here</span><br><span class="line">      enum RawBitsToken &#123; RAW_BITS &#125;;</span><br><span class="line">                          ^</span><br><span class="line">    /Users/ydcun-pro/workspace/openjdk/jdk8/hotspot/src/share/vm/code/relocInfo.hpp:464:10: error: calling a protected constructor of class <span class="string">'relocInfo'</span></span><br><span class="line">      <span class="built_in">return</span> relocInfo(relocInfo::data_prefix_tag, relocInfo::RAW_BITS, relocInfo::datalen_tag | datalen);</span><br><span class="line">             ^</span><br><span class="line">    /Users/ydcun-pro/workspace/openjdk/jdk8/hotspot/src/share/vm/code/relocInfo.hpp:273:3: note: declared protected here</span><br><span class="line">      relocInfo(relocType <span class="built_in">type</span>, RawBitsToken ignore, int bits)</span><br><span class="line">      ^</span><br></pre></td></tr></table></figure>
<p>修改relocInfo.hpp,编辑 <em>hotspot/src/share/vm/code/relocInfo.hpp</em><br>
修改367行为:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">friend</span> relocInfo <span class="title">prefix_relocInfo</span><span class="params">(<span class="keyword">int</span> datalen)</span></span>;</span><br></pre></td></tr></table></figure>
<p>修改462行为:</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> relocInfo <span class="title">prefix_relocInfo</span><span class="params">(<span class="keyword">int</span> datalen = <span class="number">0</span>)</span> </span>&#123;</span><br></pre></td></tr></table></figure>
<ol start="2">
<li>解决错误</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/Users/chou/Documents/work/projects/jdk8/hotspot/src/share/vm/runtime/virtualspace.cpp:331:14: error: ordered comparison between pointer and zero (<span class="string">'char *'</span> and <span class="string">'int'</span>)</span><br><span class="line">  <span class="keyword">if</span> (base() &gt; 0) &#123;</span><br><span class="line">      ~~~~~~ ^ ~</span><br></pre></td></tr></table></figure>
<p>编辑 <em>hotspot/src/share/vm/runtime/virtualspace.cpp</em> , 修改331行为</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (base() != <span class="literal">NULL</span>) &#123;</span><br></pre></td></tr></table></figure>
<ol start="3">
<li>解决错误</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/Users/lican/hg_bak/jdk8u-dev/hotspot/src/share/vm/opto/lcm.cpp:52:34: error: ordered comparison between pointer and zero (<span class="string">'address'</span> (aka <span class="string">'unsigned char *'</span>) and <span class="string">'int'</span>)</span><br><span class="line">  <span class="keyword">if</span> (Universe::narrow_oop_base()&gt;0) &#123; // Implies UseCompressedOops.</span><br><span class="line">      ~~~~~~~~~~~~~~~~~~~~~~~~~~~^~</span><br></pre></td></tr></table></figure>
<p>编辑 <em>hotspot/src/share/vm/opto/lcm.cpp</em> , 修改52行为</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (Universe::narrow_oop_base() != <span class="literal">NULL</span>) &#123;</span><br></pre></td></tr></table></figure>
<ol start="4">
<li>解决错误</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Exception <span class="keyword">in</span> thread <span class="string">"main"</span> java.lang.VerifyError: class jdk.nashorn.internal.objects.ScriptFunctionImpl overrides final method getPrototype.()Ljava/lang/Object;</span><br><span class="line">    at java.lang.ClassLoader.defineClass1(Native Method)</span><br><span class="line">    at java.lang.ClassLoader.defineClass(ClassLoader.java:763)</span><br><span class="line">    at java.security.SecureClassLoader.defineClass(SecureClassLoader.java:142)</span><br><span class="line">    at java.net.URLClassLoader.defineClass(URLClassLoader.java:467)</span><br><span class="line">    at java.net.URLClassLoader.access<span class="variable">$100</span>(URLClassLoader.java:73)</span><br><span class="line">    at java.net.URLClassLoader<span class="variable">$1</span>.run(URLClassLoader.java:368)</span><br><span class="line">    at java.net.URLClassLoader<span class="variable">$1</span>.run(URLClassLoader.java:362)</span><br><span class="line">    at java.security.AccessController.doPrivileged(Native Method)</span><br><span class="line">    at java.net.URLClassLoader.findClass(URLClassLoader.java:361)</span><br><span class="line">    at java.lang.ClassLoader.loadClass(ClassLoader.java:424)</span><br><span class="line">    at sun.misc.Launcher<span class="variable">$AppClassLoader</span>.loadClass(Launcher.java:349)</span><br><span class="line">    at java.lang.ClassLoader.loadClass(ClassLoader.java:357)</span><br><span class="line">    at jdk.nashorn.internal.tools.nasgen.StringConstants.&lt;clinit&gt;(StringConstants.java:85)</span><br><span class="line">    at jdk.nashorn.internal.tools.nasgen.ScriptClassInstrumentor<span class="variable">$2</span>.visitMethodInsn(ScriptClassInstrumentor.java:157)</span><br><span class="line">    at jdk.internal.org.objectweb.asm.MethodVisitor.visitMethodInsn(MethodVisitor.java:509)</span><br><span class="line">    at jdk.internal.org.objectweb.asm.ClassReader.readCode(ClassReader.java:1445)</span><br><span class="line">    at jdk.internal.org.objectweb.asm.ClassReader.readMethod(ClassReader.java:1046)</span><br><span class="line">    at jdk.internal.org.objectweb.asm.ClassReader.accept(ClassReader.java:722)</span><br><span class="line">    at jdk.internal.org.objectweb.asm.ClassReader.accept(ClassReader.java:535)</span><br><span class="line">    at jdk.nashorn.internal.tools.nasgen.Main.process(Main.java:121)</span><br><span class="line">    at jdk.nashorn.internal.tools.nasgen.Main.processAll(Main.java:88)</span><br><span class="line">    at jdk.nashorn.internal.tools.nasgen.Main.main(Main.java:62)</span><br></pre></td></tr></table></figure>
<p>编辑 <em>nashorn/make/BuildNashorn.gmk</em> , 修改80行:<br>
原:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-cp &quot;$(NASHORN_OUTPUTDIR)/nasgen_classes$(PATH_SEP)$(NASHORN_OUTPUTDIR)/nashorn_classes&quot; \</span><br></pre></td></tr></table></figure>
<p>修改后</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-Xbootclasspath/p:&quot;$(NASHORN_OUTPUTDIR)/nasgen_classes$(PATH_SEP)$(NASHORN_OUTPUTDIR)/nashorn_classes&quot; \</span><br></pre></td></tr></table></figure>
<p>本文链接 <a href="http://blog.elegantme.cn/Mac%E4%B8%8B%E7%BC%96%E8%AF%91OpenJDK8/">http://blog.elegantme.cn/Mac下编译OpenJDK8/</a> 转载请标明出处</p>

  </div>
  
    <!-- 添加捐赠图标 -->
<div class="post-donate">
    <div id="donate_board" class="donate_bar center">
        <a id="btn_donate" class="btn_donate" href="javascript:;" title="打赏"></a>
        <span class="donate_txt">
           ↑<br>
           如果觉得不错,就稍稍给个鼓励吧~
        </span>
        <br>
      </div>  
    <div id="donate_guide" class="donate_bar center hidden">
        <!-- 支付宝打赏图案 -->
        <img src="/images/Alipay.jpg" alt="支付宝打赏">
        <!-- 微信打赏图案 -->
        <img src="/images/WeChatpay.jpg" alt="微信打赏">
    </div>
    <script type="text/javascript">
        document.getElementById('btn_donate').onclick = function(){
            $('#donate_board').addClass('hidden');
            $('#donate_guide').removeClass('hidden');
        }
    </script>
</div>
<!-- 添加捐赠图标 -->
  
   <div>本篇文章<span class="post-count">1.3k</span>字</div>
</article>

    <div class="blog-post-comments">
        <div id="disqus_thread">
            <noscript>Please enable JavaScript to view the comments.</noscript>
        </div>
    </div>



        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/xiaohundun">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#当前环境"><span class="toc-number">1.</span> <span class="toc-text"> 当前环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#下载源码"><span class="toc-number">2.</span> <span class="toc-text"> 下载源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#安装依赖"><span class="toc-number">3.</span> <span class="toc-text"> 安装依赖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#xquartz"><span class="toc-number">3.1.</span> <span class="toc-text"> XQuartz</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#freetype"><span class="toc-number">3.2.</span> <span class="toc-text"> freetype</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#gun组件"><span class="toc-number">3.3.</span> <span class="toc-text"> GUN组件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#进行编译"><span class="toc-number">4.</span> <span class="toc-text"> 进行编译</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#错误列表"><span class="toc-number">5.</span> <span class="toc-text"> 错误列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bash-configure过程中可能会遇到的错误"><span class="toc-number">5.1.</span> <span class="toc-text"> bash ./configure过程中可能会遇到的错误:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#make-all过程中可能遇到的错误"><span class="toc-number">5.2.</span> <span class="toc-text"> make all过程中可能遇到的错误:</span></a></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://blog.elegantme.cn/Mac下编译OpenJDK8/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&text=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&is_video=false&description=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Mac下编译OpenJDK8及虚拟机实践&body=Check out this article: http://blog.elegantme.cn/Mac下编译OpenJDK8/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&title=Mac下编译OpenJDK8及虚拟机实践"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://blog.elegantme.cn/Mac下编译OpenJDK8/&name=Mac下编译OpenJDK8及虚拟机实践&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 xiaohundun
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="https://github.com/xiaohundun">Projects</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </nav>
  </div>
  本站文章共<span class="post-count">13k</span>字
</footer>

    </div>
</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

    <script type="text/javascript">
        (function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-128998234-1', 'auto');
        ga('send', 'pageview');
    </script>

<!-- Baidu Analytics -->

    <script type="text/javascript">
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?2e6da3c375c8a87f5b664cea6d4cb29c";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

<!-- Disqus Comments -->

    <script type="text/javascript">
        var disqus_shortname = 'xiaohundun';

        (function(){
            var dsq = document.createElement('script');
            dsq.type = 'text/javascript';
            dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        }());
    </script>


